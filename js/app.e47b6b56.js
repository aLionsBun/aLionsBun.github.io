(function(e){function t(t){for(var r,o,i=t[0],u=t[1],m=t[2],d=0,l=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&l.push(a[o][0]),a[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);c&&c(t);while(l.length)l.shift()();return s.push.apply(s,m||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,i=1;i<n.length;i++){var u=n[i];0!==a[u]&&(r=!1)}r&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={app:0},s=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var m=0;m<i.length;m++)t(i[m]);var c=u;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0065":function(e,t,n){"use strict";n("9629")},"034f":function(e,t,n){"use strict";n("85ec")},"332e":function(e,t,n){"use strict";n("d337")},5581:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"nav"}},[n("h1",[e._v("Welcome to Network Magica")]),n("br"),n("div",{staticStyle:{display:"inline"},attrs:{id:"guest"}},[n("router-link",{attrs:{to:"/"}},[e._v("Home")]),e._v(" || "),n("router-link",{attrs:{to:"/login"}},[e._v("Log in")]),e._v(" || "),n("router-link",{attrs:{to:"/register"}},[e._v("Sign up")])],1),n("div",{staticStyle:{display:"none"},attrs:{id:"user"}},[n("router-link",{attrs:{to:"/chatrooms"}},[e._v("Chat rooms")]),n("br")],1)]),n("router-view")],1)},s=[],o=n("1da1"),i=(n("96cf"),n("5530")),u=n("522d"),m=n("efe7"),c=n("c2c3");r["a"].use(u["a"]);var d="apollo-token",l="https://webprogbase-lab6-graphql.herokuapp.com/",p=Object({NODE_ENV:"production",VUE_APP_APOLLO_ENGINE_KEY:"",VUE_APP_APOLLO_ENGINE_SERVICE:"",VUE_APP_APOLLO_ENGINE_TAG:"",VUE_APP_GRAPHQL_HTTP:"https://webprogbase-lab6-graphql.herokuapp.com/",VUE_APP_GRAPHQL_WS:"wss://webprogbase-lab6-graphql.herokuapp.com/graphql",BASE_URL:"/"}).VUE_APP_FILES_ROOT||l.substr(0,l.indexOf("/graphql"));r["a"].prototype.$filesRoot=p;var h=Object(c["setContext"])((function(e,t){var n=t.headers,r=localStorage.getItem(d);return{headers:Object(i["a"])(Object(i["a"])({},n),{},{authorization:r?"Bearer ".concat(r):""})}})),_={httpEndpoint:l,wsEndpoint:"wss://webprogbase-lab6-graphql.herokuapp.com/graphql",tokenName:d,persisting:!1,websocketsOnly:!1,ssr:!1,link:h};function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(m["createApolloClient"])(Object(i["a"])(Object(i["a"])({},_),e)),n=t.apolloClient,r=t.wsClient;n.wsClient=r;var a=new u["a"]({defaultClient:n,defaultOptions:{$query:{}},errorHandler:function(e){console.log("%cError","background: red; color: white; padding: 2px 4px; border-radius: 3px; font-weight: bold;",e.message)}});return a}function g(e,t){return b.apply(this,arguments)}function b(){return b=Object(o["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return"undefined"!==typeof localStorage&&n&&localStorage.setItem(d,n),t.wsClient&&Object(m["restartWebsockets"])(t.wsClient),e.prev=2,e.next=5,t.resetStore();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](2),console.log("%cError on cache reset (login)","color: orange;",e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[2,7]])}))),b.apply(this,arguments)}function f(e){return w.apply(this,arguments)}function w(){return w=Object(o["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return"undefined"!==typeof localStorage&&localStorage.removeItem(d),t.wsClient&&Object(m["restartWebsockets"])(t.wsClient),e.prev=2,e.next=5,t.resetStore();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](2),console.log("%cError on cache reset (logout)","color: orange;",e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[2,7]])}))),w.apply(this,arguments)}function E(){return localStorage.getItem(d)}var O,y,R,x,j,C,$,S,M,k,P,A,q,I,D,L,U,N,T,B={name:"App",mounted:function(){var e=this.$root.$apolloProvider.defaultClient;window.addEventListener("unload",Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,f(e);case 2:case"end":return t.stop()}}),t)}))))},watch:{$route:function(){var e=E();document.getElementById("user").style.display=null===e?"none":"inline",document.getElementById("guest").style.display=null===e?"inline":"none"}}},G=B,J=(n("034f"),n("2877")),H=Object(J["a"])(G,a,s,!1,null,null,null),V=H.exports,W=n("8c4f"),K=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},F=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("h1",[e._v("Chat freely with magicians from all over the globe!")])])}],Q={name:"Home"},Y=Q,z=(n("c560"),Object(J["a"])(Y,K,F,!1,null,"88114382",null)),X=z.exports,Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("h1",[e._v("Log in as existing user")]),n("form",{on:{submit:function(t){return t.preventDefault(),e.Login(t)}}},[e._m(0),n("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{required:"",name:"username",id:"username",placeholder:"Username"},domProps:{value:e.username},on:{input:[function(t){t.target.composing||(e.username=t.target.value)},e.checkUsername]}}),n("br"),n("div",{staticStyle:{display:"none",color:"red"},attrs:{id:"warning"}},[e._v("There is no such user. Please, enter another username")]),n("br"),e._m(1),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{required:"",type:"password",name:"password",id:"password",placeholder:"Secret password"},domProps:{value:e.password},on:{input:[function(t){t.target.composing||(e.password=t.target.value)},e.checkUsername]}}),n("br"),n("br"),n("div",{staticStyle:{display:"none",color:"red"},attrs:{id:"passwd_err"}},[e._v("Password for this user is incorrect. Please, try again")]),n("br"),n("br"),n("button",{attrs:{id:"btn",disabled:""}},[e._v("Log in!")])])])},ee=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("Username:"),n("br")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("Password:"),n("br")])}],te=n("8785"),ne=n("5184"),re=Object(ne["a"])(O||(O=Object(te["a"])(["query checkUsername($username: String!) {\n  user: usernameExists(username: $username)\n}"]))),ae=Object(ne["a"])(y||(y=Object(te["a"])(["query login($username: String!, $password: String!) {\n  login(username: $username, password: $password)\n}"]))),se=Object(ne["a"])(R||(R=Object(te["a"])(["query register($username: String!, $password: String!) {\n  register(username: $username, password: $password) {\n    id\n    username\n    timestamp\n  }\n}"]))),oe=Object(ne["a"])(x||(x=Object(te["a"])(["query me {\n  me {\n    id\n    username\n    timestamp\n    currentRoom {\n      id\n      name\n      owner {username}\n      lastMessages\n      {\n        id\n        timestamp\n        author\n        {username}\n        text\n      }\n    }\n  }\n}"]))),ie=Object(ne["a"])(j||(j=Object(te["a"])(["query rooms {\n  rooms {\n    id\n    name\n    owner {username}\n  }\n}"]))),ue=Object(ne["a"])(C||(C=Object(te["a"])(["query users {\n  users {\n    id\n    username\n    currentRoom {\n      id\n      name\n    }\n    rooms {id}\n  }\n}"]))),me=Object(ne["a"])($||($=Object(te["a"])(["mutation createRoom($name: String!) {\n  createRoom(name: $name) {\n    id\n    name\n    owner {username}\n  }\n}"]))),ce=Object(ne["a"])(S||(S=Object(te["a"])(["mutation updateRoom($id: ID!, $name: String!) {\n  updateRoom(id: $id, name: $name) {\n    id \n    name\n    owner {username}\n  }\n}"]))),de=Object(ne["a"])(M||(M=Object(te["a"])(["mutation deleteRoom($id: ID!) {\n  deleteRoom(id: $id) {\n    id \n    name\n    owner {username}\n  }\n}"]))),le=Object(ne["a"])(k||(k=Object(te["a"])(["mutation join($roomId: ID!) {\n  joinRoom(roomId: $roomId) {\n    id\n    name\n    lastMessages\n    {\n      id\n      timestamp\n      author {username}\n      text\n    }\n  }\n}"]))),pe=Object(ne["a"])(P||(P=Object(te["a"])(["mutation leave {\n  leaveCurrentRoom {\n    id \n    name\n  }\n}"]))),he=Object(ne["a"])(A||(A=Object(te["a"])(["mutation createMessage($text: String!) {\n  createMessage(text: $text) {\n    id\n    timestamp\n    author {username}\n    text\n  }\n}"]))),_e=Object(ne["a"])(q||(q=Object(te["a"])(["subscription roomCreated {\n  roomCreated {\n    id name owner {username}\n  }\n}"]))),ve=Object(ne["a"])(I||(I=Object(te["a"])(["subscription roomUpdated {\n  roomUpdated {\n    id name owner {username}\n  }\n}"]))),ge=Object(ne["a"])(D||(D=Object(te["a"])(["subscription roomDeleted {\n  roomDeleted {\n    id name owner {username}\n  }\n}"]))),be=Object(ne["a"])(L||(L=Object(te["a"])(["subscription currentRoomChanged {\n  currentRoomChanged {\n    currentRoom {id name}\n  }\n}"]))),fe=Object(ne["a"])(U||(U=Object(te["a"])(["subscription memberJoined {\n  memberJoined {\n    id\n    username\n    currentRoom {\n      id\n      name\n    }\n    rooms {id}\n  }\n}"]))),we=Object(ne["a"])(N||(N=Object(te["a"])(["subscription memberLeft {\n  memberLeft {id username}\n}"]))),Ee=Object(ne["a"])(T||(T=Object(te["a"])(["subscription messageCreated {\n  messageCreated {\n    id\n    timestamp\n    author {username}\n    text\n  }\n}"]))),Oe={CHECK_USERNAME:re,LOGIN:ae,REGISTER:se,ME:oe,ROOMS:ie,USERS:ue,CREATE_ROOM:me,UPDATE_ROOM:ce,DELETE_ROOM:de,JOIN:le,LEAVE:pe,CREATE_MESSAGE:he,ROOM_CREATED:_e,ROOM_UPDATED:ve,ROOM_DELETED:ge,CURRENT_ROOM_CHANGED:be,MEMBER_JOINED:fe,MEMBER_LEFT:we,MESSAGE_CREATED:Ee},ye={name:"Login",data:function(){return{username:"",password:""}},methods:{checkUsername:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$apollo.query({query:Oe.CHECK_USERNAME,variables:{username:e.username}});case 2:n=t.sent,!1===n.data.user?(document.getElementById("btn").disabled=!0,document.getElementById("warning").style.display="inline"):(document.getElementById("warning").style.display="none",0!==e.username.length&&0!==e.password.length?document.getElementById("btn").disabled=!1:document.getElementById("btn").disabled=!0);case 4:case"end":return t.stop()}}),t)})))()},Login:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return document.getElementById("passwd_err").style.display="none",t.next=3,e.$apollo.query({query:Oe.LOGIN,variables:{username:e.username,password:e.password}}).then(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=n.data,t.next=3,g(e.$root.$apolloProvider.defaultClient,r.login);case 3:e.$router.push({name:"Chatrooms"});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log(e),document.getElementById("passwd_err").style.display="inline"}));case 3:case"end":return t.stop()}}),t)})))()}}},Re=ye,xe=(n("0065"),Object(J["a"])(Re,Z,ee,!1,null,"da2bbedc",null)),je=xe.exports,Ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("h1",[e._v("Registering new user")]),n("form",{on:{submit:function(t){return t.preventDefault(),e.Register(t)}}},[e._m(0),n("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{required:"",name:"username",id:"username",placeholder:"Username"},domProps:{value:e.username},on:{input:[function(t){t.target.composing||(e.username=t.target.value)},e.checkUsername]}}),n("br"),n("div",{staticStyle:{display:"none",color:"red"},attrs:{id:"warning"}},[e._v("This username is taken. Please, pick another username")]),n("br"),e._m(1),n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{required:"",type:"password",name:"password",id:"password",placeholder:"Secret password"},domProps:{value:e.password},on:{input:[function(t){t.target.composing||(e.password=t.target.value)},e.checkUsername]}}),n("br"),n("br"),n("button",{attrs:{id:"btn",disabled:""}},[e._v("Sign up!")])])])},$e=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("Username:"),n("br")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("Password:"),n("br")])}],Se={name:"Register",data:function(){return{user:[],username:"",password:""}},methods:{checkUsername:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$apollo.query({query:Oe.CHECK_USERNAME,variables:{username:e.username}});case 2:n=t.sent,!0===n.data.user?(document.getElementById("btn").disabled=!0,document.getElementById("warning").style.display="inline"):(document.getElementById("warning").style.display="none",0!==e.username.length&&0!==e.password.length?document.getElementById("btn").disabled=!1:document.getElementById("btn").disabled=!0);case 4:case"end":return t.stop()}}),t)})))()},Register:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$apollo.query({query:Oe.REGISTER,variables:{username:e.username,password:e.password}}).then(Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:window.alert("Registration successful! Welcome to our secret club"),e.$router.push({path:"/"});case 2:case"end":return t.stop()}}),t)})))).catch((function(e){console.log(e),window.alert("Oops,we're sorry, but something went wrong. Try again later")}));case 2:case"end":return t.stop()}}),t)})))()}}},Me=Se,ke=(n("332e"),Object(J["a"])(Me,Ce,$e,!1,null,"0f70db3e",null)),Pe=ke.exports,Ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.is_chatting,expression:"!is_chatting"}],attrs:{id:"out_chat"}},[n("div",{staticClass:"item",attrs:{id:"chat_list"}},[n("div",{style:[e.rooms.length?{display:"none"}:{display:"inline"}]},[e._v("Loading...")]),n("ul",{attrs:{id:"rendered_chat_list"}},e._l(e.rooms,(function(t,r){return n("li",{key:t.id,class:{active:r==e.active_index},style:[t.owner.username===e.me.username?{"background-color":"aqua"}:{"background-color":"transparent"}],on:{click:function(t){return e.toggleActive(r)}}},[n("i",[n("b",[e._v(e._s(t.name))])])])})),0)]),n("div",{staticClass:"item",attrs:{id:"out_chat_buttons"}},[n("form",{attrs:{id:"join_form"},on:{submit:function(t){return t.preventDefault(),e.Join(t)}}},[n("div",[e._v("Selected chat room: "+e._s(e.active_room.name))]),n("br"),n("button",{attrs:{id:"join_room",disabled:!e.active_room.name.length}},[e._v("Join")]),n("br"),n("br")]),n("div",{attrs:{id:"info"}},[n("b",[e._v("Note, "+e._s(e.me.username)+": rooms that belong to you"),n("br"),e._v(" have light blue background. "),n("br"),n("br"),e._v(" You will be able to change their name and"),n("br"),e._v(" delete them after you join them.")])]),n("br"),n("br"),n("form",{attrs:{id:"create_form"},on:{submit:function(t){return t.preventDefault(),e.createRoom(t)}}},[e._m(0),n("br"),n("input",{directives:[{name:"model",rawName:"v-model",value:e.new_chat_name,expression:"new_chat_name"}],attrs:{id:"new_chat_name"},domProps:{value:e.new_chat_name},on:{input:function(t){t.target.composing||(e.new_chat_name=t.target.value)}}}),n("br"),n("br"),n("button",{attrs:{id:"create_room",disabled:!e.new_chat_name.length}},[e._v("Create new room")]),n("br"),n("br"),n("br")])])]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.is_chatting,expression:"is_chatting"}],attrs:{id:"in_chat"}},[n("div",{staticClass:"item",attrs:{id:"user_list"}},[n("div",{style:[e.chat_users.length?{display:"none"}:{display:"inline"}]},[e._v("Loading...")]),n("ul",{attrs:{id:"rendered_user_list"}},e._l(e.chat_users,(function(t){return n("li",{key:t.id,style:[t.username===e.me.username?{"background-color":"aqua"}:{"background-color":"transparent"}]},[n("i",[n("b",[e._v(e._s(t.username))])])])})),0)]),n("div",{staticClass:"item",attrs:{id:"messages_view"}},[n("ul",{attrs:{id:"rendered_message_list"}},[n("div",{style:[e.messages.length?{display:"none"}:{display:"inline"}]},[e._v("No messages yet")]),e._l(e.messages,(function(t){return n("li",{key:t.id,style:[t.author.username===e.me.username?{color:"purple","text-align":"right"}:{color:"black","text-align":"left"}]},[0!==t.id.length?n("p",[n("br"),e._v("Sent by: "+e._s(t.author.username)),n("br"),e._v(e._s(t.text)),n("br")]):n("p",{style:{"text-align":"center"}},[n("b",[n("br"),e._v(e._s(t.text)),n("br")])])])}))],2)]),n("div",{staticClass:"item",attrs:{id:"in_chat_buttons"}},[n("div",[e._v("Selected chat room: "+e._s(e.active_room.name))]),n("br"),n("form",{attrs:{id:"leave_form"},on:{submit:function(t){return t.preventDefault(),e.Leave(t)}}},[n("button",{attrs:{id:"leave_room",disabled:!e.chat_users.length}},[e._v("Leave")]),n("br"),n("br")]),n("form",{attrs:{id:"send_message_form"},on:{submit:function(t){return t.preventDefault(),e.createMessage(t)}}},[n("p",[e._v("Say something:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"text"}],attrs:{id:"chat_message_text"},domProps:{value:e.text},on:{input:function(t){t.target.composing||(e.text=t.target.value)}}}),n("button",{attrs:{id:"send_message",disabled:!e.text.length}},[e._v("Speak")])]),n("br"),n("div",{directives:[{name:"show",rawName:"v-show",value:e.me.username===e.active_room.owner.username,expression:"me.username===active_room.owner.username"}],attrs:{id:"admin_in_chat"}},[n("form",{attrs:{id:"rename_form"},on:{submit:function(t){return t.preventDefault(),e.updateRoom(t)}}},[n("div",[e._v("Enter current room's new name")]),n("br"),n("input",{directives:[{name:"model",rawName:"v-model",value:e.updated_chat_name,expression:"updated_chat_name"}],attrs:{id:"updated_chat_name"},domProps:{value:e.updated_chat_name},on:{input:function(t){t.target.composing||(e.updated_chat_name=t.target.value)}}}),n("br"),n("br"),n("button",{attrs:{id:"rename_room",disabled:!e.updated_chat_name.length}},[e._v("Rename current room")]),n("br"),n("br")]),n("form",{attrs:{id:"delete_form"},on:{submit:function(t){return t.preventDefault(),e.deleteRoom(t)}}},[n("button",{attrs:{id:"delete_room",disabled:!e.chat_users.length}},[e._v("Delete current room")])])])])])])},qe=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._v("Enter new room's name"),n("br"),e._v("(you will be the owner of this room)")])}],Ie=(n("c740"),n("7db0"),n("a434"),n("b0c0"),n("99af"),n("4de4"),{name:"Chatrooms",data:function(){return{active_index:null,active_room:{id:"",name:"",owner:{username:""}},chat_users:[],is_chatting:!1,me:{id:"",username:"",timestamp:"",currentRoom:{id:"",name:"",owner:{username:""}}},messages:[],new_chat_name:"",rooms:[],text:"",updated_chat_name:"",users:[]}},apollo:{me:Oe.ME,rooms:Oe.ROOMS,users:Oe.USERS,$subscribe:{currentRoomChanged:{query:Oe.CURRENT_ROOM_CHANGED},memberJoined:{query:Oe.MEMBER_JOINED,result:function(e){var t=e.data;this.me.id!==t.memberJoined.id&&this.chat_users.findIndex((function(e){return e.id===t.memberJoined.id}))<0&&(this.chat_users.push(t.memberJoined),this.messages.push({id:"",timestamp:Date.now(),author:{username:""},text:"".concat(t.memberJoined.username," joined")}))}},memberLeft:{query:Oe.MEMBER_LEFT,result:function(e){var t=e.data;if(this.me.id!==t.memberLeft.id){var n=this.chat_users.find((function(e){return e.id=t.memberLeft.id}));this.chat_users.splice(n,1),this.messages.push({id:"",timestamp:Date.now(),author:{username:""},text:"".concat(t.memberLeft.username," left")})}}},messageCreated:{query:Oe.MESSAGE_CREATED,result:function(e){var t=e.data;this.messages.push({id:t.messageCreated.id,timestamp:t.messageCreated.timestamp,author:{username:t.messageCreated.author.username},text:t.messageCreated.text})}},roomCreated:{query:Oe.ROOM_CREATED,result:function(e){var t=e.data;this.rooms.push({id:t.roomCreated.id,name:t.roomCreated.name,owner:{username:t.roomCreated.owner.username}})}},roomUpdated:{query:Oe.ROOM_UPDATED,result:function(e){var t=e.data;if(this.is_chatting)this.active_room.name=t.roomUpdated.name,this.me.currentRoom.name=t.roomUpdated.name,this.messages.push({id:"",timestamp:Date.now(),author:{username:""},text:"".concat(this.me.username," renamed chat to ").concat(t.roomUpdated.name)});else{var n=this.rooms.findIndex((function(e){return e.id===t.roomUpdated.id}));this.rooms[n].name=t.roomUpdated.name,n===this.active_index&&(this.active_room.name=t.roomUpdated.name)}}},roomDeleted:{query:Oe.ROOM_DELETED,result:function(e){var t=e.data,n=this.rooms.findIndex((function(e){return e.id===t.roomDeleted.id}));this.rooms.splice(n,1),n===this.active_index&&(this.active_index=null,this.active_room={id:"",name:"",owner:{username:""}}),this.is_chatting&&(alert("Admin decided that's enough discussion for today and deleted this room. \nEveryone can go home now. Thank you for participating"),this.updated_chat_name="",this.me.currentRoom={id:"",name:"",owner:{username:""}},this.messages=[],this.chat_users=[],this.is_chatting=!1)}}}},methods:{Join:function(){var e=this;this.is_chatting=!0,this.new_chat_name="",this.$apollo.mutate({mutation:Oe.JOIN,variables:{roomId:this.active_room.id}}).then((function(t){var n=t.data;e.me.currentRoom=e.active_room;for(var r=0;r<n.joinRoom.lastMessages.length;r++)e.messages.push({id:n.joinRoom.lastMessages[r].id,timestamp:n.joinRoom.lastMessages[r].timestamp,author:{username:n.joinRoom.lastMessages[r].author.username},text:n.joinRoom.lastMessages[r].text});e.$apollo.queries.users.refetch().then((function(t){var n=t.data;e.chat_users=n.users.filter((function(t){return null!==t.currentRoom&&t.currentRoom.id===e.me.currentRoom.id})),0!==e.chat_users.length&&void 0!==e.chat_users.find((function(t){return t.username===e.me.username}))||e.chat_users.push(e.me)}))}))},Leave:function(){var e=this;this.is_chatting=!1,this.active_index=null,this.updated_chat_name="",this.$apollo.mutate({mutation:Oe.LEAVE}).then((function(){e.me.currentRoom={id:"",name:"",owner:{username:""}},e.active_room={id:"",name:"",owner:{username:""}},e.messages=[],e.chat_users=[],e.$apollo.queries.rooms.refetch().then((function(t){var n=t.data;e.rooms=n.rooms}))}))},createMessage:function(){var e=this;this.$apollo.mutate({mutation:Oe.CREATE_MESSAGE,variables:{text:this.text}}).then((function(){e.text=""}))},createRoom:function(){var e=this;this.$apollo.mutate({mutation:Oe.CREATE_ROOM,variables:{name:this.new_chat_name}}).then((function(){e.new_chat_name=""}))},updateRoom:function(){var e=this;this.$apollo.mutate({mutation:Oe.UPDATE_ROOM,variables:{id:this.active_room.id,name:this.updated_chat_name}}).then((function(){e.updated_chat_name=""}))},deleteRoom:function(){this.$apollo.mutate({mutation:Oe.DELETE_ROOM,variables:{id:this.active_room.id}})},toggleActive:function(e){this.active_index=e,this.active_room=this.rooms[e]}},created:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$apollo.queries.me.refetch().then((function(t){var n=t.data;e.me=n.me;var r=n.me.currentRoom;if(null===r||0===r.id.length)e.is_chatting=!1,e.me.currentRoom={id:"",name:"",owner:{username:""}},e.$apollo.queries.rooms.refetch().then((function(t){var n=t.data;e.rooms=n.rooms}));else{e.is_chatting=!0,e.active_room={id:r.id,name:r.name,owner:{username:r.owner.username}};for(var a=0;a<r.lastMessages.length;a++)e.messages.push({id:r.lastMessages[a].id,timestamp:r.lastMessages[a].timestamp,author:{username:r.lastMessages[a].author.username},text:r.lastMessages[a].text});e.$apollo.queries.users.refetch().then((function(t){var n=t.data;e.chat_users=n.users.filter((function(t){return null!==t.currentRoom&&t.currentRoom.id===e.me.currentRoom.id})),0!==e.chat_users.length&&void 0!==e.chat_users.find((function(t){return t.username===e.me.username}))||e.chat_users.push(e.me)}))}}));case 1:case"end":return t.stop()}}),t)})))()}}),De=Ie,Le=(n("5e6b"),Object(J["a"])(De,Ae,qe,!1,null,"79448ffe",null)),Ue=Le.exports;r["a"].use(W["a"]);var Ne=[{path:"/",name:"Home",component:X,meta:{guest:!0}},{path:"/login",name:"Login",component:je,meta:{guest:!0}},{path:"/register",name:"Register",component:Pe,meta:{guest:!0}},{path:"/chatrooms",name:"Chatrooms",component:Ue,meta:{requiresAuth:!0}}],Te=new W["a"]({mode:"history",base:"/",routes:Ne});Te.beforeEach((function(e,t,n){var r=E();e.matched.some((function(e){return e.meta.requiresAuth}))?null===r?n({path:"/"}):n():e.matched.some((function(e){return e.meta.guest}))&&null!==r?n({path:"/chatrooms"}):n()}));var Be=Te;r["a"].config.productionTip=!1;var Ge=new r["a"]({el:"#app",router:Be,apolloProvider:v(),render:function(e){return e(V)}});Ge.$mount("#app")},"5e6b":function(e,t,n){"use strict";n("5581")},"85ec":function(e,t,n){},9629:function(e,t,n){},b397:function(e,t,n){},c560:function(e,t,n){"use strict";n("b397")},d337:function(e,t,n){}});
//# sourceMappingURL=app.e47b6b56.js.map